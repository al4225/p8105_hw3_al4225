---
title: "p8105_hw3_al4225"
author: "Anjing"
date: "2022-10-10"
output: github_document
---

```{r}
library(tidyverse)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

## Problem 2

### Wrangling
Load, tidy, and otherwise wrangle the data. Your final dataset should include all originally observed variables and values; have useful variable names; include a weekday vs weekend variable; and encode data with reasonable variable classes. Describe the resulting dataset (e.g. what variables exist, how many observations, etc).

**Steps**:
First, I load and clean the data.
Second, I create a day_type variable to show whether the day is weekday or weekend.
Third, I group by the data according to week and day_id.
Forth, I use pivot_longer to tidy the activity counts and minutes.
Fifth, I round the value of activity counts with 0 digits and change activity_minute to integer values.
At last, I adjust the order of the columns.

**Discription**:
There are `r accel_data = read_csv("./data/accel_data.csv",
                col_names = TRUE) %>%
  janitor::clean_names() %>%
  drop_na() %>%
  mutate(
    day_type = ifelse(day %in% c("Saturday", "Sunday"), "weekend", "weekday")) %>%
  group_by(week,day_id) %>%
  pivot_longer(
    activity_1:activity_1440, 
    names_to = "activity_minute", 
    values_to = "activity_counts",
    names_prefix = "activity_") %>%
  mutate(
    activity_counts = round(activity_counts, digits = 0),
    activity_minute = as.integer(activity_minute)) %>%
    select(week, day_id, day, day_type, everything())
nrow(accel_data)` observations and `r accel_data = read_csv("./data/accel_data.csv",
                col_names = TRUE) %>%
  janitor::clean_names() %>%
  drop_na() %>%
  mutate(
    day_type = ifelse(day %in% c("Saturday", "Sunday"), "weekend", "weekday")) %>%
  group_by(week,day_id) %>%
  pivot_longer(
    activity_1:activity_1440, 
    names_to = "activity_minute", 
    values_to = "activity_counts",
    names_prefix = "activity_") %>%
  mutate(
    activity_counts = round(activity_counts, digits = 0),
    activity_minute = as.integer(activity_minute)) %>%
    select(week, day_id, day, day_type, everything())
ncol(accel_data)` variables. Each observation represents the activity counts for each minute of a 24-hour day starting at midnight in the day of given week. There are some key variables such as week, day_id, day, day_type and activity_minute and activity_counts. 
```{r}
accel_data = read_csv("./data/accel_data.csv",
                col_names = TRUE) %>%
  janitor::clean_names() %>%
  drop_na() %>%
  mutate(
    day_type = ifelse(day %in% c("Saturday", "Sunday"), "weekend", "weekday")) %>%
  group_by(week,day_id) %>%
  pivot_longer(
    activity_1:activity_1440, 
    names_to = "activity_minute", 
    values_to = "activity_counts",
    names_prefix = "activity_") %>%
  mutate(
    activity_counts = round(activity_counts, digits = 0),
    activity_minute = as.integer(activity_minute)) %>%
    select(week, day_id, day, day_type, everything())
nrow(accel_data)
ncol(accel_data)

accel_data
```

